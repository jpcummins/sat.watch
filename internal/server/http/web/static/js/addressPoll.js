(()=>{document.addEventListener("alpine:init",()=>{Alpine.data("addressPoll",()=>({pending:[],init(){setTimeout(()=>{let i=document.querySelectorAll('td[data-pending="true"]');this.pending=Array.from(i).map(t=>t.closest("tr")?.dataset.addressId).filter(Boolean).filter((t,n,e)=>e.indexOf(t)===n),this.poll(),setInterval(()=>this.poll(),5e3)},0)},async poll(){if(!this.pending.length)return;let i=encodeURIComponent(this.pending.join(",")),t=await fetch(`/app/addresses/status?ids=${i}`,{headers:{Accept:"application/json"}});if(!t.ok)return;let n=await t.json();Array.isArray(n)&&(n.forEach(e=>{let s=document.querySelector(`[data-address-id="${e.id}"]`);if(!s)return;let a=s.querySelector(".utxo-count-cell"),d=s.querySelector(".balance-cell");a.textContent=e.utxoCount.toString(),d.textContent=e.balance.toString(),a.dataset.pending="false",d.dataset.pending="false"}),this.pending=this.pending.filter(e=>!n.some(s=>s.id===e)))}}))});})();
